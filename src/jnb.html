<!DOCTYPE html>
<html>
<head>
    <title>Jump n Bump - HTML5</title>
    <meta name="description" content="An instant real-time network-only keyboard-crowding classic, this game pits up to four human-operated cute fuzzy widdle bunnies against each other for one goal only: lagomorphic cranial domination.">
    <link rel="shortcut icon" href="rabbit.ico" />
    <style type="text/css">
        body, html { width: 100%; height: 100%; margin: 0; padding:0; }
        canvas { margin:auto; border: 0px solid black; }
        img { float:right; }
        br { clear: both; }
        body { color: #cccccc; background-color: black}
        a { color: #bbbbbb; }
        .noscrollbar { overflow:hidden; }
        .pause { min-width: 130px; }
        .resource { display:none; }
        .top-bar { margin: 0 auto; }
        .top-bar * { display: inline-block; text-align: center; }
        .top-bar li { margin: 0 10px; }
        .scores { margin-top: 50px; margin-bottom: 50px; }
        .scores * { font-size: 32px; }
        .scores th,td { padding: 8px; text-align: center; }
        .centre-column { margin: 0 auto; max-width: 600px; }
        .canvas-container { text-align: center; }
    </style>
</head>
<body data-bind="css: { noscrollbar: current_page() === Page.Game }">
    <img class="resource" id='level' src='levels/default/level.png' alt=""/>
    <img class="resource" id='mask' src='levels/default/mask.png' alt=""/>
    <img class="resource" id='objects' src='sprites/objects.png' alt=""/>
    <img class="resource" id='numbers' src='sprites/numbers.png' alt=""/>
    <img class="resource" id='rabbits' src='sprites/rabbit.png' alt=""/>
    <div data-bind="visible: current_page() !== Page.Instructions" class="top-bar">
        <button class="pause" data-bind="visible: current_page() === Page.Game, click: current_game().pause" >Pause game (P)</button>
        <button class="pause" data-bind="visible: current_page() === Page.Scores, click: current_game().unpause">Unpause game (P)</button>
        <ul>
            <li>F11: full screen</li>
            <li>M: toggle sound</li>
            <li>P: toggle pause</li>
            <li>1-4: toggle player 1-4</li>
            <li>Alt + 1-4: toggle AI for player 1-4</li>
            <li>Arrows: control player 1</li>
            <li>WAD: control player 2</li>
            <li>JIL: control player 3</li>
            <li>NumPad: control player 4</li>
        </ul>
    </div>
    <div data-bind="visible: current_page() === Page.Game" class="canvas-container">
        <canvas id="screen" width="1200" height="768"></canvas>
    </div>
    <div data-bind="visible: current_page() == Page.Scores" class="centre-column">
        <table data-bind="with: scores_viewmodel" class="scores">
            <tr>
                <!-- ko foreach: player_row -->
                    <th data-bind="text: $data"></th>
                <!-- /ko -->
            </tr>
            <tbody>
                <!-- ko foreach: score_rows -->
                    <tr>
                        <th data-bind="text: $data[0]"></th>
                        <!-- ko foreach: $data -->
                            <!-- ko if: $index() != 0 -->
                                <td data-bind="text: $data"></td>
                            <!-- /ko -->
                        <!-- /ko -->
                    </tr>
                <!-- /ko -->
            </tbody>
        </table>

        <br />
        
    </div>
    <div data-bind="visible: current_page() == Page.Instructions" class="centre-column">
        <h2>Jump 'n' Bump</h2>
        <img src="jbcircle.png" alt="small preview of the game"/>
        <p>
            This game is a HTML5 reimplementation of a <a href="https://github.com/fschulze/jumpnbump">open source</a> <a href="https://icculus.org/jumpnbump/">DOS classic</a>. Maybe you would like to take a look at the <a href="https://github.com/GrahamTheCoder/jump-n-bump">Source code</a>?
        </p>
    </div>
    <div data-bind="visible: (current_page() != Page.Game && current_page() != Page.Waiting_For_Players)" class="centre-column">
        <button data-bind="click: restart, disable: loading_level">Start new local game</button>
        <fieldset>
            <input type="text" placeholder="Enter Player Name" data-bind="value: server_player_name, valueUpdate: 'keyup'" />
            <button data-bind="click: init_network_game, enable: canStartNetworkGame()">Start online game</button>
        </fieldset>
        <fieldset>
            <input type="text" placeholder="Enter Player Name" data-bind="value: client_player_name, valueUpdate: 'keyup'" />
            <input type="text" placeholder="Enter Game ID" data-bind="value: client_game_id, valueUpdate: 'keyup'" />
            <button data-bind="click: join_network_game, enable: canJoinNetworkGame()">Join online game</button>
        </fieldset>
        <h3>Load level:</h3>
        <select data-bind="options: availableLevels, optionsText: 'name', value: selected_custom_level, event: { change: on_level_change }"></select>
        <p>Load any level found online, for example <a href="http://aiei.ch/linux/jumpnbump/?1" target="_blank">this repository</a></p>
        <input id="level_input" type="file" accept=".dat" data-bind="event: { change: function() { load_level_from_file($element.value, $element.files[0]) } }" />
        <br />
    </div>
    <div data-bind="if: (current_page() == Page.Waiting_For_Players && server_player_name())" class="centre-column">
        <h2 data-bind="if: !server_game_id()">Preparing Game Server...</h2>
        <div data-bind="if: server_game_id()">
            <h2>Game Server Ready</h2>
            <p>Your Game ID is <span style="font-weight: 700;" data-bind="text: server_game_id"></span>. Share with other players so they can connect!</p>
            <ul data-bind="foreach: server_network_players">
                <li>
                    <span data-bind="if: $data">
                        Player <span data-bind="text: $index() + 1"></span>: <span data-bind="text: $data"></span>
                    </span>
                    <span data-bind="if: !$data">
                        Player <span data-bind="text: $index() + 1"></span> not assigned
                    </span>
                </li>
            </ul>
            <button data-bind="click: start_network_game">Start Game</button>
        </div>
    </div>
    <div data-bind="if: (current_page() == Page.Waiting_For_Players && client_player_name())" class="centre-column">
        <h2>Waiting for server to start game...</h2>
    </div>
</body>
</html>
